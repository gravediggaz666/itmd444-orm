{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createPubSub = void 0;\nconst repeater_1 = require(\"@repeaterjs/repeater\");\nconst events_1 = require(\"@whatwg-node/events\");\n/**\n * Utility for publishing and subscribing to events.\n */\nconst createPubSub = config => {\n  const target = config?.eventTarget ?? new EventTarget();\n  return {\n    publish(routingKey, ...args) {\n      const payload = args[1] ?? args[0] ?? null;\n      const topic = args[1] === undefined ? routingKey : `${routingKey}:${args[0]}`;\n      const event = new events_1.CustomEvent(topic, {\n        detail: payload\n      });\n      target.dispatchEvent(event);\n    },\n    subscribe(...[routingKey, id]) {\n      const topic = id === undefined ? routingKey : `${routingKey}:${id}`;\n      return new repeater_1.Repeater(function subscriptionRepeater(next, stop) {\n        stop.then(function subscriptionRepeaterStopHandler() {\n          target.removeEventListener(topic, pubsubEventListener);\n        });\n        target.addEventListener(topic, pubsubEventListener);\n        function pubsubEventListener(event) {\n          next(event.detail);\n        }\n      });\n    }\n  };\n};\nexports.createPubSub = createPubSub;","map":{"version":3,"names":["Object","defineProperty","exports","value","createPubSub","repeater_1","require","events_1","config","target","eventTarget","EventTarget","publish","routingKey","args","payload","topic","undefined","event","CustomEvent","detail","dispatchEvent","subscribe","id","Repeater","subscriptionRepeater","next","stop","then","subscriptionRepeaterStopHandler","removeEventListener","pubsubEventListener","addEventListener"],"sources":["/Users/snawz1/node_modules/@graphql-yoga/subscription/cjs/create-pub-sub.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createPubSub = void 0;\nconst repeater_1 = require(\"@repeaterjs/repeater\");\nconst events_1 = require(\"@whatwg-node/events\");\n/**\n * Utility for publishing and subscribing to events.\n */\nconst createPubSub = (config) => {\n    const target = config?.eventTarget ?? new EventTarget();\n    return {\n        publish(routingKey, ...args) {\n            const payload = args[1] ?? args[0] ?? null;\n            const topic = args[1] === undefined ? routingKey : `${routingKey}:${args[0]}`;\n            const event = new events_1.CustomEvent(topic, {\n                detail: payload,\n            });\n            target.dispatchEvent(event);\n        },\n        subscribe(...[routingKey, id]) {\n            const topic = id === undefined ? routingKey : `${routingKey}:${id}`;\n            return new repeater_1.Repeater(function subscriptionRepeater(next, stop) {\n                stop.then(function subscriptionRepeaterStopHandler() {\n                    target.removeEventListener(topic, pubsubEventListener);\n                });\n                target.addEventListener(topic, pubsubEventListener);\n                function pubsubEventListener(event) {\n                    next(event.detail);\n                }\n            });\n        },\n    };\n};\nexports.createPubSub = createPubSub;\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,YAAY,GAAG,KAAK,CAAC;AAC7B,MAAMC,UAAU,GAAGC,OAAO,CAAC,sBAAsB,CAAC;AAClD,MAAMC,QAAQ,GAAGD,OAAO,CAAC,qBAAqB,CAAC;AAC/C;AACA;AACA;AACA,MAAMF,YAAY,GAAII,MAAM,IAAK;EAC7B,MAAMC,MAAM,GAAGD,MAAM,EAAEE,WAAW,IAAI,IAAIC,WAAW,CAAC,CAAC;EACvD,OAAO;IACHC,OAAOA,CAACC,UAAU,EAAE,GAAGC,IAAI,EAAE;MACzB,MAAMC,OAAO,GAAGD,IAAI,CAAC,CAAC,CAAC,IAAIA,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI;MAC1C,MAAME,KAAK,GAAGF,IAAI,CAAC,CAAC,CAAC,KAAKG,SAAS,GAAGJ,UAAU,GAAI,GAAEA,UAAW,IAAGC,IAAI,CAAC,CAAC,CAAE,EAAC;MAC7E,MAAMI,KAAK,GAAG,IAAIX,QAAQ,CAACY,WAAW,CAACH,KAAK,EAAE;QAC1CI,MAAM,EAAEL;MACZ,CAAC,CAAC;MACFN,MAAM,CAACY,aAAa,CAACH,KAAK,CAAC;IAC/B,CAAC;IACDI,SAASA,CAAC,GAAG,CAACT,UAAU,EAAEU,EAAE,CAAC,EAAE;MAC3B,MAAMP,KAAK,GAAGO,EAAE,KAAKN,SAAS,GAAGJ,UAAU,GAAI,GAAEA,UAAW,IAAGU,EAAG,EAAC;MACnE,OAAO,IAAIlB,UAAU,CAACmB,QAAQ,CAAC,SAASC,oBAAoBA,CAACC,IAAI,EAAEC,IAAI,EAAE;QACrEA,IAAI,CAACC,IAAI,CAAC,SAASC,+BAA+BA,CAAA,EAAG;UACjDpB,MAAM,CAACqB,mBAAmB,CAACd,KAAK,EAAEe,mBAAmB,CAAC;QAC1D,CAAC,CAAC;QACFtB,MAAM,CAACuB,gBAAgB,CAAChB,KAAK,EAAEe,mBAAmB,CAAC;QACnD,SAASA,mBAAmBA,CAACb,KAAK,EAAE;UAChCQ,IAAI,CAACR,KAAK,CAACE,MAAM,CAAC;QACtB;MACJ,CAAC,CAAC;IACN;EACJ,CAAC;AACL,CAAC;AACDlB,OAAO,CAACE,YAAY,GAAGA,YAAY","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}