{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.findType = void 0;\nconst errors_1 = require(\"../errors\");\nconst utils_1 = require(\"../metadata/utils\");\nconst returnTypes_1 = require(\"./returnTypes\");\nfunction findTypeValueArrayDepth([typeValueOrArray], innerDepth = 1) {\n  if (!Array.isArray(typeValueOrArray)) {\n    return {\n      depth: innerDepth,\n      returnType: typeValueOrArray\n    };\n  }\n  return findTypeValueArrayDepth(typeValueOrArray, innerDepth + 1);\n}\nfunction findType({\n  metadataKey,\n  prototype,\n  propertyKey,\n  parameterIndex,\n  argName,\n  returnTypeFunc,\n  typeOptions = {}\n}) {\n  const options = {\n    ...typeOptions\n  };\n  let metadataDesignType;\n  (0, utils_1.ensureReflectMetadataExists)();\n  const reflectedType = Reflect.getMetadata(metadataKey, prototype, propertyKey);\n  if (reflectedType) {\n    if (metadataKey === \"design:paramtypes\") {\n      metadataDesignType = reflectedType[parameterIndex];\n    } else {\n      metadataDesignType = reflectedType;\n    }\n  }\n  if (!returnTypeFunc && (!metadataDesignType || returnTypes_1.bannedTypes.includes(metadataDesignType))) {\n    throw new errors_1.NoExplicitTypeError(prototype.constructor.name, propertyKey, parameterIndex, argName);\n  }\n  if (returnTypeFunc) {\n    const getType = () => {\n      const returnTypeFuncReturnValue = returnTypeFunc();\n      if (Array.isArray(returnTypeFuncReturnValue)) {\n        const {\n          depth,\n          returnType\n        } = findTypeValueArrayDepth(returnTypeFuncReturnValue);\n        options.array = true;\n        options.arrayDepth = depth;\n        return returnType;\n      }\n      return returnTypeFuncReturnValue;\n    };\n    return {\n      getType,\n      typeOptions: options\n    };\n  }\n  if (metadataDesignType) {\n    return {\n      getType: () => metadataDesignType,\n      typeOptions: options\n    };\n  }\n  throw new Error(\"Ops... this should never happen :)\");\n}\nexports.findType = findType;","map":{"version":3,"names":["Object","defineProperty","exports","value","findType","errors_1","require","utils_1","returnTypes_1","findTypeValueArrayDepth","typeValueOrArray","innerDepth","Array","isArray","depth","returnType","metadataKey","prototype","propertyKey","parameterIndex","argName","returnTypeFunc","typeOptions","options","metadataDesignType","ensureReflectMetadataExists","reflectedType","Reflect","getMetadata","bannedTypes","includes","NoExplicitTypeError","constructor","name","getType","returnTypeFuncReturnValue","array","arrayDepth","Error"],"sources":["/Users/snawz1/node_modules/type-graphql/build/cjs/helpers/findType.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.findType = void 0;\nconst errors_1 = require(\"../errors\");\nconst utils_1 = require(\"../metadata/utils\");\nconst returnTypes_1 = require(\"./returnTypes\");\nfunction findTypeValueArrayDepth([typeValueOrArray], innerDepth = 1) {\n    if (!Array.isArray(typeValueOrArray)) {\n        return { depth: innerDepth, returnType: typeValueOrArray };\n    }\n    return findTypeValueArrayDepth(typeValueOrArray, innerDepth + 1);\n}\nfunction findType({ metadataKey, prototype, propertyKey, parameterIndex, argName, returnTypeFunc, typeOptions = {}, }) {\n    const options = { ...typeOptions };\n    let metadataDesignType;\n    (0, utils_1.ensureReflectMetadataExists)();\n    const reflectedType = Reflect.getMetadata(metadataKey, prototype, propertyKey);\n    if (reflectedType) {\n        if (metadataKey === \"design:paramtypes\") {\n            metadataDesignType = reflectedType[parameterIndex];\n        }\n        else {\n            metadataDesignType = reflectedType;\n        }\n    }\n    if (!returnTypeFunc && (!metadataDesignType || returnTypes_1.bannedTypes.includes(metadataDesignType))) {\n        throw new errors_1.NoExplicitTypeError(prototype.constructor.name, propertyKey, parameterIndex, argName);\n    }\n    if (returnTypeFunc) {\n        const getType = () => {\n            const returnTypeFuncReturnValue = returnTypeFunc();\n            if (Array.isArray(returnTypeFuncReturnValue)) {\n                const { depth, returnType } = findTypeValueArrayDepth(returnTypeFuncReturnValue);\n                options.array = true;\n                options.arrayDepth = depth;\n                return returnType;\n            }\n            return returnTypeFuncReturnValue;\n        };\n        return {\n            getType,\n            typeOptions: options,\n        };\n    }\n    if (metadataDesignType) {\n        return {\n            getType: () => metadataDesignType,\n            typeOptions: options,\n        };\n    }\n    throw new Error(\"Ops... this should never happen :)\");\n}\nexports.findType = findType;\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,QAAQ,GAAG,KAAK,CAAC;AACzB,MAAMC,QAAQ,GAAGC,OAAO,CAAC,WAAW,CAAC;AACrC,MAAMC,OAAO,GAAGD,OAAO,CAAC,mBAAmB,CAAC;AAC5C,MAAME,aAAa,GAAGF,OAAO,CAAC,eAAe,CAAC;AAC9C,SAASG,uBAAuBA,CAAC,CAACC,gBAAgB,CAAC,EAAEC,UAAU,GAAG,CAAC,EAAE;EACjE,IAAI,CAACC,KAAK,CAACC,OAAO,CAACH,gBAAgB,CAAC,EAAE;IAClC,OAAO;MAAEI,KAAK,EAAEH,UAAU;MAAEI,UAAU,EAAEL;IAAiB,CAAC;EAC9D;EACA,OAAOD,uBAAuB,CAACC,gBAAgB,EAAEC,UAAU,GAAG,CAAC,CAAC;AACpE;AACA,SAASP,QAAQA,CAAC;EAAEY,WAAW;EAAEC,SAAS;EAAEC,WAAW;EAAEC,cAAc;EAAEC,OAAO;EAAEC,cAAc;EAAEC,WAAW,GAAG,CAAC;AAAG,CAAC,EAAE;EACnH,MAAMC,OAAO,GAAG;IAAE,GAAGD;EAAY,CAAC;EAClC,IAAIE,kBAAkB;EACtB,CAAC,CAAC,EAAEjB,OAAO,CAACkB,2BAA2B,EAAE,CAAC;EAC1C,MAAMC,aAAa,GAAGC,OAAO,CAACC,WAAW,CAACZ,WAAW,EAAEC,SAAS,EAAEC,WAAW,CAAC;EAC9E,IAAIQ,aAAa,EAAE;IACf,IAAIV,WAAW,KAAK,mBAAmB,EAAE;MACrCQ,kBAAkB,GAAGE,aAAa,CAACP,cAAc,CAAC;IACtD,CAAC,MACI;MACDK,kBAAkB,GAAGE,aAAa;IACtC;EACJ;EACA,IAAI,CAACL,cAAc,KAAK,CAACG,kBAAkB,IAAIhB,aAAa,CAACqB,WAAW,CAACC,QAAQ,CAACN,kBAAkB,CAAC,CAAC,EAAE;IACpG,MAAM,IAAInB,QAAQ,CAAC0B,mBAAmB,CAACd,SAAS,CAACe,WAAW,CAACC,IAAI,EAAEf,WAAW,EAAEC,cAAc,EAAEC,OAAO,CAAC;EAC5G;EACA,IAAIC,cAAc,EAAE;IAChB,MAAMa,OAAO,GAAGA,CAAA,KAAM;MAClB,MAAMC,yBAAyB,GAAGd,cAAc,CAAC,CAAC;MAClD,IAAIT,KAAK,CAACC,OAAO,CAACsB,yBAAyB,CAAC,EAAE;QAC1C,MAAM;UAAErB,KAAK;UAAEC;QAAW,CAAC,GAAGN,uBAAuB,CAAC0B,yBAAyB,CAAC;QAChFZ,OAAO,CAACa,KAAK,GAAG,IAAI;QACpBb,OAAO,CAACc,UAAU,GAAGvB,KAAK;QAC1B,OAAOC,UAAU;MACrB;MACA,OAAOoB,yBAAyB;IACpC,CAAC;IACD,OAAO;MACHD,OAAO;MACPZ,WAAW,EAAEC;IACjB,CAAC;EACL;EACA,IAAIC,kBAAkB,EAAE;IACpB,OAAO;MACHU,OAAO,EAAEA,CAAA,KAAMV,kBAAkB;MACjCF,WAAW,EAAEC;IACjB,CAAC;EACL;EACA,MAAM,IAAIe,KAAK,CAAC,oCAAoC,CAAC;AACzD;AACApC,OAAO,CAACE,QAAQ,GAAGA,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}